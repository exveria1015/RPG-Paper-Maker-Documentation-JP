<h1>タイルセットと衝突</h1>

## -- 概要

このセクションでは、タイルの設定方法と、マップ内でオブジェクトが移動できる場所を決定する衝突について説明します。さらに、オブジェクト同士がどのように相互作用するかについての基本もいくつか紹介します。&#x20;

## -- タイルセット <a href="#tilesets" id="tilesets"></a>

タイルセットは、各マップに描画できる個々のタイルをすべて含むファイルです。タイルセットはいくつでも持つことができますが、マップごとに選択できるタイルセットは1つだけです。マップが使用するタイルセットは、ゲーム中にコマンドで変更できます。&#x20;

データベースエントリでは、これらのタイルのさまざまなプロパティを設定できます。複数のエントリに同じタイルセットを使用し、それぞれに異なるプロパティを設定できます。&#x20;

タイルセットファイルは、プロジェクトフォルダ内の /images/textures/tilesets に配置する必要があります。

### 新しいタイルセットを追加する

データマネージャーを開き、「タイルセット」タブをクリックします。

<figure><img src="../.gitbook/assets/image (64).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (51).png" alt=""><figcaption></figcaption></figure>

すべてのデータリストと同様に、+ をクリックして新しいエントリを作成します。&#x20;

<figure><img src="../.gitbook/assets/tileset3.png" alt=""><figcaption></figcaption></figure>

次に、「画像」ボタンをクリックしてタイルセットファイルを選択します。&#x20;

<figure><img src="../.gitbook/assets/tileset4.png" alt=""><figcaption></figcaption></figure>

使用するファイルが左側にあることと、[OK] をクリックする前にハイライトされていることを確認してください。&#x20;

<figure><img src="../.gitbook/assets/tileset5.png" alt=""><figcaption><p>右側のファイルはプロジェクトフォルダにあります。表示されない場合は、「利用可能なコンテンツを表示」チェックボックスをオンにします。</p></figcaption></figure>

### タイルセットのプロパティ

これで新しいタイルセットエントリができたので、プロパティを設定します。設定しないと、プレイヤーはすべての上/中を歩くことができます。&#x20;

### - バトルマップ

「バトルマップ」設定では、マップでランダムバトルを許可した場合にデフォルトで使用されるマップ/位置を選択できます（マッププロパティ> バトルタブにあります）。

<figure><img src="../.gitbook/assets/tileset6.png" alt=""><figcaption><p>これらは、システム> バトルシステムタブで作成されます。</p></figcaption></figure>

タイルセットでこのオプションを設定する必要はありません。マッププロパティでも設定できます。&#x20;

### - 通行可能&#x20;

このタブでは、タイルがスプライトとして使用される場合にのみ適用される衝突を設定できます。この設定は、床タイルには影響しません。&#x20;

<figure><img src="../.gitbook/assets/tileset7.png" alt=""><figcaption></figcaption></figure>

タイルをクリックして、点線の正方形を作成します。次に、エッジをドラッグして正方形のサイズを変更できます。大きなオブジェクトの場合は、複数のタイルをクリックする必要があります。&#x20;

右クリックして「編集」を選択すると、特定の数値を使用してより正確な正方形を使用できます。&#x20;

<figure><img src="../.gitbook/assets/tileset8.png" alt=""><figcaption></figcaption></figure>

正方形を削除するには、正方形をクリックして紫色でハイライトしてから、キーボードの Delete キーを押します。または、正方形を右クリックして「削除」を選択することもできます。&#x20;

### - 方向&#x20;

このタブは、タイルが床タイルとして使用される場合に、オブジェクトがタイル上をどのように歩くことができるかを制御します。&#x20;

<figure><img src="../.gitbook/assets/image (7) (1).png" alt=""><figcaption></figcaption></figure>

各タイルには、プレイヤーがタイルのどちら側から歩くことができるかを決定する4つの矢印があります。&#x20;

矢印は、その側から歩くことができることを意味します。&#x20;

正方形は、歩くことができないことを意味します。

個々の矢印をクリックして変更できます。中央の正方形をクリックすると、それぞれが切り替わります。矢印は正方形になり、正方形は矢印になります。&#x20;

一般的な使用例を次に示します。赤い線は歩くことができない場所を示しています。

<figure><img src="../.gitbook/assets/image (4) (1).png" alt=""><figcaption></figcaption></figure>

1. 北側からしか入れないタイル
2. まったく歩くことができないタイル
3. 南北方向のみに移動を許可するタイル
4. 東西方向のみに移動を許可するタイル

### - 地形

このタブでは、各タイルにID番号を割り当てることができます。このID番号は、コード内でオブジェクトが立っているタイルを識別するために使用できます。これにより、オブジェクトの速度を遅くしたり、ダメージを与えたり、そのタイルにジャンプできるかどうかを確認したりするなど、さまざまな用途に使用できます。&#x20;

<figure><img src="../.gitbook/assets/image (5) (1).png" alt=""><figcaption></figcaption></figure>

左クリックすると数値が増加し、右クリックすると数値が減少します。

地形IDを使用するには、まず「変数を設定」コマンドを使用します。

<figure><img src="../.gitbook/assets/image (50).png" alt=""><figcaption></figcaption></figure>

オブジェクトが立っているタイルを確認し、地形IDを変数に書き込みます。次に、「条件」を使用して、特定のIDが見つかった場合に何が起こるかを決定できます。

<figure><img src="../.gitbook/assets/image (49).png" alt=""><figcaption></figcaption></figure>

### - 登攀

このタブでは、スプライトとして使用される場合に、タイルに登ることができるかどうかを設定できます。有効にすると、オブジェクトがタイルにぶつかると、自動的に片側を登り、反対側を降ります。&#x20;

<figure><img src="../.gitbook/assets/image (6) (1).png" alt=""><figcaption></figcaption></figure>

O は、登ることができることを意味します。

X は、登ることができないことを意味します。

プレイヤーが最初に登り始めると、どちらの方向を向いていても、その方向が「前方」になります。反対方向を押すと「後方」になり、来た道を戻ることができます。

頂上に達すると、床タイルとして扱われる小さなエリアがあります。端に接触するまでは普通に歩き回ることができ、端に接触すると、接触した側から降り始めます。

これは新しい機能であり、少しバグが発生する可能性があります。はしごとして使用する場合、スプライトの配置は非常に重要です。はしごの上部からより高い地面に移動できるように、上部は床タイルの端に近づけて配置する必要があります。&#x20;

システム> システムタブに、登攀速度を決定する設定があります。

<figure><img src="../.gitbook/assets/image (8) (1).png" alt=""><figcaption><p>変数を使用してゲーム中に調整できます</p></figcaption></figure>



これらのタブのいくつかでは、ズームを変更できます。

<figure><img src="../.gitbook/assets/image (34).png" alt=""><figcaption></figcaption></figure>

## -- その他の種類

マップに配置できる特別なタイルには、他にもいくつか種類があります。それらにはそれぞれ、エディタに独自の描画ツールとインポート方法があります。&#x20;

現在、これらはすべてタイルセットにリンクされています。新しいタイルセットを作成する場合、リストに表示するには、それらをすべて再度インポートする必要があります。&#x20;

保持したい場合は、タイルセットエントリをコピーして、これらすべてを含めることができます。ただし、「通行可能」、「方向」、「地形」、「登攀」の各設定をすべて調整する必要があります。&#x20;

バージョン3.0以降、これらはタイルセットにリンクされなくなります。そのため、使用するタイルセットに関係なく、すべてが常に利用可能になります。&#x20;

### - オートタイル&#x20;

これらは、同じタイルを隣に描画すると形状が変化する特別な床タイルです。いくつかのプリセットタイルの一部を使用して、連続した形状を形成します。道路や水などの表現によく使用されます。&#x20;

オートタイルファイルは、プロジェクトフォルダ内の /images/textures/autotiles に配置する必要があります。

<figure><img src="../.gitbook/assets/image (67).png" alt=""><figcaption></figcaption></figure>

グラフィックファイルのレイアウトの例を次に示します。

<figure><img src="../.gitbook/assets/image (52).png" alt=""><figcaption><p>これは古い情報ですか？</p></figcaption></figure>

最初の正方形は、単一のタイルを描画するときに使用されます。その隣は、角に使用されるパーツを含む正方形です。その下は、長い線と反転した角に使用される正方形です。エンジンはこれらのタイルの 1/4 または 1/2 を使用して、形状全体を作成します。&#x20;

新しいものを追加するには、「オートタイル」アイコンをクリックします。

<figure><img src="../.gitbook/assets/image (54).png" alt=""><figcaption></figcaption></figure>

+ をクリックして新しいエントリを追加し、「テクスチャ」ボタンをクリックしてそのエントリのファイルを選択します。

<figure><img src="../.gitbook/assets/image (55).png" alt=""><figcaption><p>この画面では、各オートタイルは単一の正方形で表され、エディタではこのように表示されます。</p></figcaption></figure>

テクスチャファイルを選択するとき、1つのファイルに複数のオートタイルを含めることができます。次のようになります。

<figure><img src="../.gitbook/assets/image (56).png" alt=""><figcaption></figcaption></figure>

アニメーション化されたオートタイルは、フレームが左から右に編成されており、次のようになります。

<figure><img src="../.gitbook/assets/image (57).png" alt=""><figcaption></figcaption></figure>

ファイル全体をアニメーションタイルとして指定するには、「アニメーション」のチェックボックスをオンにする必要があります。したがって、同じファイル内にアニメーションタイルと非アニメーションタイルを混在させることはできません。&#x20;

「アニメーション」のチェックボックスをオンにすると、一番上の行のすべてのフレームが同じオートタイルのものであると想定されます。その行のすべてのフレームがグループ化されます。オートタイルをさらに追加するには、横ではなく下に配置する必要があります。&#x20;

オートタイルのフレーム数と速度は、システムマネージャーで設定します。

<figure><img src="../.gitbook/assets/image (32) (1).png" alt=""><figcaption></figcaption></figure>

すべてのファイルをインポートしたら、リストに追加する必要があります。最初に、「オートタイル」描画ツールを選択します。

<figure><img src="../.gitbook/assets/image (66).png" alt=""><figcaption></figcaption></figure>

次に、左側の「リストの更新」をクリックします。

<figure><img src="../.gitbook/assets/image (61).png" alt=""><figcaption><p>この手順は、バージョン3.0以降は必要ない場合があります。</p></figcaption></figure>

使用できるように、左に移動します。

<figure><img src="../.gitbook/assets/image (63).png" alt=""><figcaption></figcaption></figure>

### - 壁

これらは、任意の長さの垂直な壁として描画できる特別なスプライトです。点Aから点Bまで、直線でしか描画できません。

壁ファイルは、プロジェクトフォルダ内の /images/textures/walls に配置する必要があります。

「壁」アイコンをクリックして、リストに新しいものを追加します。

<figure><img src="../.gitbook/assets/image (68).png" alt=""><figcaption></figcaption></figure>

「壁」描画ツールを使用するときに使用できるように、左側に移動します。&#x20;

<figure><img src="../.gitbook/assets/image (69).png" alt=""><figcaption></figcaption></figure>

壁の開始点を示す白い線が表示されます。&#x20;

<figure><img src="../.gitbook/assets/image (70).png" alt=""><figcaption></figcaption></figure>

マウスの左ボタンをクリックしてドラッグすると、壁が延長されます。ボタンを離すと終了します。&#x20;

<figure><img src="../.gitbook/assets/image (71).png" alt=""><figcaption></figcaption></figure>

直線を作成しないと、壁が消えて赤い線が表示されます。つまり、そのように描画することはできません。このようにマウスボタンを離すと、試行はキャンセルされます。&#x20;

<figure><img src="../.gitbook/assets/image (72).png" alt=""><figcaption></figcaption></figure>

壁を削除するには、壁の任意の部分を右クリックしてマウスをドラッグします。離すと、壁のその部分が削除されます。&#x20;

<figure><img src="../.gitbook/assets/image (73).png" alt=""><figcaption></figcaption></figure>

### - 3Dオブジェクト

これらは、より多くの詳細とオプションが利用可能な特別なオブジェクトです。Blenderなどの外部プログラムで事前に作成したり、画像テクスチャをボックスに巻き付けて作成したりできます。&#x20;

3Dオブジェクトファイルは、プロジェクトフォルダ内の /images/textures/objects3D に配置する必要があります。

詳細については、「3Dオブジェクト」セクションを参照してください。

[3d-objects.md](3d-objects.md "mention")

### - 山

これらは、さまざまなサイズと形状の立方体または形状を形成するために使用される特別なテクスチャです。主に山として使用されますが、階段やドアなどの他の目的にも創造的に使用できます。&#x20;

山ファイルは、プロジェクトフォルダ内の /images/textures/mountains に配置する必要があります。

「山」アイコンをクリックして、リストに追加します。

<figure><img src="../.gitbook/assets/image (22) (1).png" alt=""><figcaption></figcaption></figure>

「山」描画ツールを使用するときに使用できるように、左側に移動します。

<figure><img src="../.gitbook/assets/image (23) (1).png" alt=""><figcaption></figcaption></figure>

使用するテクスチャを選択し、「設定」を調整してサイズと形状を選択します。

これらのデフォルト設定では、1タイル×1タイルの立方体が作成されます。px単位の実際のサイズは、システム設定の「正方形のサイズ」によって異なります。山の衝突の高さ角度は、オブジェクトが山とどのように相互作用するかに影響します。

<figure><img src="../.gitbook/assets/image (25) (1).png" alt=""><figcaption></figcaption></figure>

「境界線の高さ」を調整して、立方体を高くしたり低くしたりします。正方形の設定を0に設定する前に、ピクセル設定を増やす必要があります。&#x20;

px単位の境界線の高さが山の衝突の高さ設定以下の場合、オブジェクトは山を登ります。&#x20;

たとえば、この山のサイズは、山の衝突の高さ設定が現在4であるため、プレイヤーが山の上を歩くことができます。

<figure><img src="../.gitbook/assets/image (26) (1).png" alt=""><figcaption></figcaption></figure>

境界線の高さの1正方形は、正方形のサイズ設定と同じです。したがって、デフォルト設定を使用する場合、境界線の高さが1正方形の山にオブジェクトが登ることができるようにするには、山の衝突の高さ設定を16に設定する必要があります。&#x20;

山を描画するときは、単一の立方体を互いの上に積み重ねたり、境界線の高さを変更したりできます。方法によって、見た目の異なる山が作成されます。&#x20;

<figure><img src="../.gitbook/assets/image (27) (1).png" alt=""><figcaption></figcaption></figure>

同じテクスチャを隣に描画すると、エンジンによってそれらが結合され、連続した壁が作成されます。異なるテクスチャは結合されません。&#x20;

<figure><img src="../.gitbook/assets/image (28) (1).png" alt=""><figcaption></figcaption></figure>

「境界線の幅」を調整すると、立方体から斜辺を持つ立方体に変化します。&#x20;

<figure><img src="../.gitbook/assets/image (29) (1).png" alt=""><figcaption></figcaption></figure>

リストされている角度は、山の衝突の角度設定に対応しています。角度が設定以下の場合、プレイヤーは斜面を上ることができます。&#x20;

山の衝突設定はどちらも変数にすることができ、ゲーム中に変更できます。

エンジンはまだ単一タイルの斜面を提供していませんが、「境界線の幅」と「境界線の高さ」を1に設定して作成できます。次に、斜辺を覆うように立方体を配置します。&#x20;

<figure><img src="../.gitbook/assets/image (30) (1).png" alt=""><figcaption><p>アクセスしやすいように、幅を2タイルにすることをお勧めします。</p></figcaption></figure>

## -- 衝突 <a href="#collisions" id="collisions"></a>

衝突は、オブジェクトが互いに、および環境とどのように相互作用するかを制御します。新しいリソースをインポートするとき、それらには衝突がありません。必ず、固体にするものすべてに衝突を設定する必要があります。そうしないと、バグが発生する可能性があります。たとえば、ヒーローが壁の中を歩いてしまうなどです。&#x20;

これらのバウンディングボックスは赤色で、オブジェクトが歩くことができる/できない場所を決定します。タイルとキャラクターの上記の設定では、赤色のバウンディングボックスを使用しています。&#x20;

他に青色のボックスがあり、これは会話や攻撃など、他のインタラクションに使用されます。「イベントを送信」コマンドは、青色のバウンディングボックスを使用します。これについては、以下で詳しく説明します。

### バウンディングボックス <a href="#bounding-boxes" id="bounding-boxes"></a>

バウンディングボックスは、2つのオブジェクト間のインタラクションをチェックするために使用される単純な幾何学的形状です。正方形の衝突を設定すると、自動的にスプライトの周りに配置される立方体に変換されます。&#x20;

<figure><img src="../.gitbook/assets/image (33) (1).png" alt=""><figcaption><p>円柱は処理に時間がかかるため、立方体を使用してパフォーマンスを向上させています。</p></figcaption></figure>

衝突を持つオブジェクトが移動すると、エンジンはその赤いバウンディングボックスが別の赤いバウンディングボックスに接触するかどうかをチェックし、移動を停止します。これが、衝突がない場合に、すべての中を歩いてしまう理由です。

敵に触れたときにダメージを受けるなど、オブジェクトのインタラクションについては、「イベントを送信」コマンドを使用して、新しい衝突/バウンディングボックスを作成します。次に、それが何かに衝突したときに何が起こるかを選択できます。これについては、以下で詳しく説明します。

再生中にバウンディングボックスを表示するには、エディタから有効にします。これは、デバッグや、動作を理解するのに役立ちます。

次のオプションをオンにします。

<figure><img src="../.gitbook/assets/image (9) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (11) (1).png" alt=""><figcaption><p>これは、ローエンドのコンピュータではラグが発生する可能性があります。</p></figcaption></figure>

カメラが北、東、南、または西を向いている場合、赤いバウンディングボックスはひし形として表示されます。&#x20;

カメラが北東や南西など、間の方向を向いている場合、赤いバウンディングボックスは正方形として表示されます。&#x20;

<figure><img src="../.gitbook/assets/image (34) (1).png" alt=""><figcaption><p>他のボックスも回転しますが、2つのボックスの相互作用方法が変わる可能性があります。</p></figcaption></figure>

形状によって、ゲームの世界でオブジェクトがどのように移動するかが異なります。床タイルは正方形になり、ヒーローはひし形になります。したがって、ひし形の先端だけが床タイルに触れていても、通過することはできません。&#x20;

<figure><img src="../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

ひし形の先端はスプライトの外観の下まで伸びているため、プレイヤーが調整するのに時間がかかる場合があります。衝突は黄色の線だけだと思うかもしれませんが、赤い三角形も含まれています。&#x20;

バウンディングボックスのエッジは、インタラクションがトリガーされるタイミングを決定します。重なっているタイミングではありません。タイルサイズが16pxの場合、バウンディングボックスの高さが16pxの場合、次のように1タイルの高さの空間の下を歩くことはできません。

<figure><img src="../.gitbook/assets/image (35).png" alt=""><figcaption></figcaption></figure>

ボックスの上端が上のタイルの下端に接触し、通過できないためです。通過できるようにするには、ボックスの高さを15pxに変更する必要があります。この動作が必要かどうかは、状況に応じて判断してください。&#x20;

### さまざまな形状 <a href="#simple-boxes-and-oriented-boxes" id="simple-boxes-and-oriented-boxes"></a>

使用するスプライトに応じて、バウンディングボックスはさまざまな形状にすることができます。

![スプライト](../.gitbook/assets/collision-boxes.png)

固定スプライトは平坦です。プレイヤーはより近くに歩くことができます。

他のタイプの