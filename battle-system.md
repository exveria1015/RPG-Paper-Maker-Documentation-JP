---
description: 何かアクションを起こす時間です。
---

# バトルシステム

RPG を作成したい場合は、バトルシステムが必要になることがあります。ここでは、バトルの実装に関連するすべての機能を見ていきます。

![バトルシステムのサンプル](https://rpg-paper-maker.github.io/basics/img/battle-demo.gif)

_注: アクション RPG（マップ上で直接戦闘を行う）を作成したい場合は、オブジェクトとイベントを使用して行うことができます_

## バトルシステムデータ <a id="battle-system-datas"></a>

バトルシステムデータの多くは、`システムマネージャー > バトルシステム` にあります。

![](.gitbook/assets/battle-system.png)

## 属性 <a id="elements"></a>

![](.gitbook/assets/elements.png)

ここでは、ダメージ効果に影響を与えるためにゲームに持たせたいすべての属性を管理できます。

* `名前`: ゲーム UI に表示される名前。
* `アイコン`: ゲーム UI に表示されるアイコン。
* **効率**: ここでは、現在の属性が他のすべての既存の属性に対してどれだけ効果的かを編集できます。これは、属性がクラスに割り当てられている場合に非常に役立ちます。デフォルトでは、x1.0（通常効果）です。

## 共通ステータス <a id="common-statistics"></a>

![ステータスパネル](https://rpg-paper-maker.github.io/basics/img/battle-statistic.png)

ここでは、バトルに影響を与えるためにゲームに持たせたいすべてのステータス（HP、レベル、強さなど）を管理できます。

* `名前`: ゲーム UI に表示される名前。
* `スクリプトの省略形`: ここで省略形を選択します。これはゲームスクリプトに使用されます。可能な場合は大文字を使用しないでください。
* **プロパティ**:
  * `固定`: チェックを入れると、このステータスは固定値（バーではない）になります。
  * `バー`: チェックを入れると、このステータスはバー値（実際の値 + 最大値）になります。

## 共通バトルコマンド <a id="common-battle-commands"></a>

![バトルコマンド](https://rpg-paper-maker.github.io/basics/img/battle-commands.png)

ヒーローを選択して何かを実行した後、どのバトルコマンドを使用するかを選択します。

* `スキル`: 対応するスキルを選択します。

ゲームでのレンダリング:

![ゲーム内メニューでのバトル](https://rpg-paper-maker.github.io/basics/img/battle-commands-preview.png)

## 共通装備 <a id="common-equipment"></a>

共通装備の名前を選択すると、これらの装備スロットに武器/防具を装備できるようになります。

## 武器/防具の種類 <a id="weapons-armors-kind"></a>

![武器/防具の種類](https://rpg-paper-maker.github.io/basics/img/battle-weapon-armor-kind.png)

武器/防具の種類を作成し、どの装備に割り当てるかを選択します。

* `名前`: この種類の武器/防具の名前。
* 割り当てることができる装備の選択。

## バトルマップ <a id="battle-maps"></a>

![バトルマップ](https://rpg-paper-maker.github.io/basics/img/battle-maps.png)

バトルマップは、実際には特定の位置（バトルの中心点を表す）に関連付けられたマップです。マップ（デフォルトではマップセレクターの `Battle Maps` フォルダー内）と位置を選択して、新しいバトルマップを追加します。

## ステータス関連付け <a id="statistics-associations"></a>

* `レベルに関連付けられたステータス`: レベルに関連付ける固定ステータスのいずれかを選択します。レベルは、キャラクターの進化に伴って増加するステータスです。レベルアップすると、他のステータスも増加します。
* `経験値に関連付けられたステータス`: 経験値に関連付けるバー統計のいずれかを選択します。経験値は、一般的にバトルの終了後に獲得されるものです。経験値が最大値に達すると、キャラクターはレベルアップし、マップの経験値バーも増加します。

## 式 <a id="formulas"></a>

* `死亡`: キャラクターが死亡したとみなす条件を定義する JavaScript の式。`u` はキャラクターに対応します。
* `クリティカルの影響`: クリティカルヒットが発生した後、新しいダメージ値を定義する JavaScript の式。`damage` は、クリティカルの影響を受けないダメージに対応します。

## バトルミュージック <a id="battle-musics"></a>

* `バトル`: バトル中に使用されるバトルミュージック。
* `レベルアップ`: ヒーローがレベルアップしたときに使用されるサウンド。
* `勝利`: 勝利のエンディングバトルフェーズで使用されるミュージック。

## 通貨 <a id="currencies"></a>

`システムマネージャー > システム` に移動します。

![通貨システム](https://rpg-paper-maker.github.io/basics/img/currencies.png)

通貨は、ゲーム内で NPC との取引やその他の方法で使用できます。

* `名前`: 通貨の名前。
* `アイコン`: 通貨に関連付けられたアイコン。

## スキル/アイテム/武器/防具 <a id="skills-items-weapons-armors"></a>

`データマネージャー` に移動します。

`スキル` タブ:

![](.gitbook/assets/battle-skills.png)

`アイテム` タブ:

![](.gitbook/assets/battle-items.png)

`武器` タブ:

![](.gitbook/assets/battle-weapons.png)

`防具` タブ:

![](https://rpg-paper-maker.github.io/basics/img/battle-armors.png)

これらの 4 つのデータには、共通のプロパティがあります。

* `名前`: データの名前。
* `種類`: アイテム/防具/武器の種類を選択します。
* `消耗品`: チェックを入れると、データを使用した後にデータが消えます。
* `片手`: _まだ利用できません。_
* `アイコン`: データに関連付けられたアイコン。
* `説明`: ゲーム内に表示されるデータの説明。
* `条件式`: _まだ利用できません。_
* `対象`: 関連する効果を適用する対象。
  * `なし`: 対象を選択しません。
  * `使用者`: 使用者のみを選択します。
  * `敵`: 敵を 1 人だけ選択します。
  * `味方`: 味方を 1 人だけ選択します。
  * `すべての敵`: すべての敵を選択します。
  * `すべての味方`: すべての味方を選択します。
* `対象条件式`: _まだ利用できません。_
* `使用可能`: データの使用可能な種類。
  * `バトルのみ`: データはバトルでのみ使用できます。
  * `メインメニューのみ`: データはメインメニューでのみ使用できます。
  * `常に`: データはバトルとメインメニューの両方で使用できます。
  * `使用不可`: データは使用できません。
* `サウンド（メインメニュー）`: メインメニューで使用したときに再生されるサウンド。
* `使用者アニメーションID`: 攻撃前に使用者に表示されるアニメーションID。
* `対象アニメーションID`: 攻撃時に対象に表示されるアニメーションID。
* `価格`: ショップメニューで購入/販売できる場合のデータの価格。

また、`コスト`、`効果`、`特性` の 3 つの共通プロパティをリストアップすることもできます。

## コスト <a id="costs"></a>

![コストパネル](https://rpg-paper-maker.github.io/basics/img/battle-costs.png)

スキルの使用コストを選択します。これは一般的に、HP、MP、TP のステータスに使用されます。キャラクターは、使用コストが足りない場合、スキルを使用できません。

* `コストを適用`: スキルを使用した後に影響を受けるデータを選択します。`ステータス`、`通貨`、`変数` のいずれかを選択できます。
  * `値`: 選択したデータに必要な値を選択します。

## 効果 <a id="effects"></a>

![](.gitbook/assets/battle-effects.png)

対象のデータに対して行われる効果を選択します。

* `ダメージ`: ダメージを与えるデータを選択します。`ステータス`、`通貨`、`変数` のいずれかを選択できます。
  * `式`: 選択したデータのダメージ値を選択します。
  * `最小`: 最終的なダメージの最小値。
  * `最大`: 最終的なダメージの最大値。
  * `属性ID`: このダメージに適用される属性。
  * `分散`: ダメージの分散（パーセント）。これはダメージにランダム性を加えます。たとえば、20% の分散を選択した場合、ダメージの範囲は次のようになります。\[ダメージ - (20 * ダメージ / 100) \| ダメージ + (20 * ダメージ / 100)\]。チェックを外した場合、分散はありません（= 0）。
  * `クリティカル`: クリティカルヒットの確率（パーセント）。チェックを外した場合、クリティカルヒットの確率はありません（= 0）。
  * `命中`: 命中率（パーセント）。チェックを外した場合、100% 命中します。
  * `値をストック`: ダメージ値を変数にストックできます。これは、たとえば次の効果に使用できます。
* `ステータスの追加/削除`: _まだ利用できません。_
* `スキルの追加/削除`: _まだ利用できません。_
* `スキルを実行`: _まだ利用できません。_
* `共通リアクションを呼び出す`: _まだ利用できません。_
* `特殊アクション`: 次の特殊アクションのいずれかを実行します。
  * `武器の効果と特性を適用`: 現在装備している武器のすべての効果を使用します。装備している武器がない場合は、この効果に続く次の効果が適用されます。
  * `スキル選択を開く`: バトルコマンドのスキル選択を開きます。
  * `アイテム選択を開く`: バトルコマンドのアイテム選択を開きます。
  * `逃げる`: バトルから逃げます。
  * `ターン終了`: チームのターンを終了します。
* `スクリプト`: _まだ利用できません。_
* `一時的に対象を変更`: この効果の対象のみを一時的に変更できます。バトラーの配列を返す必要があります。例: `[u.battler]` はアイテム/スキル/武器の使用者になります。

## 特性 <a id="characteristics"></a>

装備時にキャラクターに追加される特性を選択します。

![特性パネル](https://rpg-paper-maker.github.io/basics/img/battle-caracteristics-buff.png)

* `バフの増加/減少`: 影響を受けるデータを選択します。次のいずれかを選択できます。

  * `ステータス値`: ステータスを選択します。バー統計の場合、最大値が増加します。
  * `属性耐性`: 耐性を適用する属性を選択します。
  * `状態異常耐性`: _まだ利用できません。_
  * `経験値獲得`: _まだ利用できません。_
  * `通貨獲得`: _まだ利用できません。_
  * `スキルコスト`: _まだ利用できません。_
  * `変数`: _まだ利用できません。_

  データの影響を選択した後、ベース値に応じてどのように影響を与えるかを選択できます。

  * `* / +`: 乗算または加算する値を選択して演算を選択します。
  * `% / 固定`: 単位値を選択します。

![特性パネル](https://rpg-paper-maker.github.io/basics/img/battle-caracteristics-character.png)

_まだ利用できません。_

![特性パネル](https://rpg-paper-maker.github.io/basics/img/battle-caracteristics-other.png)

_まだ利用できません。_

## クラス <a id="classes"></a>

![データマネージャー > 防具タブ](https://rpg-paper-maker.github.io/basics/img/battle-classes.png)

各キャラクターにはクラスがあります。クラスは、キャラクターが持つことができる多くの属性を定義します。

* **経験値**: レベルに応じた経験値の進行状況を定義します。セルを `ダブルクリック` することで、経験値の列を手動で編集できることに注意してください。
  * `次のレベルまで`: テーブルは、次のレベルに進むために獲得する必要がある経験値の数を示しています。
  * `合計`: テーブルは、次のレベルに進むために蓄積する必要がある経験値の合計数を示しています。
  * `初期レベル`: 可能な初期レベル。
  * `最大レベル`: 可能な最大レベル。
  * `ベース`: 初期レベルで持つ必要がある経験値の数。
  * `インフレーション`: ベースとレベルに応じて経験値の進行状況を変更するインフレーション値。
  * `リセット`: デフォルト値にリセットします。
* **ステータスの進行状況**: レベルアップ時のステータスの進行状況を変更します。
  * **情報**:
    * `ステータス`: システムステータスのいずれかを選択します。
    * `最大値`: 可能な最大値。アイテムによってボーナス値が追加される可能性があるため、これは必ずしも最終値と一致するわけではありません。
  * **固定**:
    * `初期値`: 初期レベルでの初期値。
    * `最終値`: 最大レベルでの最終値。
    * `スライダーの進行状況`:
      * `遅い`: 経験値は最初はゆっくりと増加し、最後は速く増加します。
      * `線形`: 経験値は一定の速度で増加します。
      * `速い`: 経験値は最初は速く増加し、最後はゆっくりと増加します。
    * `ランダムな変動`: 進行状況関数に適用される分散。これは常に最大値につながることに注意してください。
  * **式**: 式を使用して値を定義します。`u` はキャラクターに対応します。
* **特性**: _まだ利用できません。_
* **習得するスキル**: レベルに応じて習得できるスキルのリストを定義します。
  * `スキル`: 習得する対応するスキル。
  * `レベル`: このスキルを習得するレベル。

## ヒーロー <a id="heroes"></a>

![データマネージャー > ヒーロータブ](https://rpg-paper-maker.github.io/basics/img/battle-heroes.png)

* `クラス`: 既存のクラスを選択します。
* `顔グラフィック`: バトル用の顔グラフィックを選択します。
* `バトラー`: バトル用のバトラーを選択します。

他のすべてのプロパティは、クラスのプロパティを継承します。`経験値` については、デフォルト値はクラスの値です。`クラスの値に設定` ボタンをクリックすると、値がクラスの値に更新されます。`ステータスの進行状況` リストには、追加の進行状況を追加できます。ステータスがすでに存在する場合、進行状況は置き換えられます。`習得するスキル` リストには、習得するスキルを追加できます。スキルがすでに存在する場合、レベルは置き換えられます。

## モンスター <a id="monsters"></a>

![データマネージャー > モンスタータブ](https://rpg-paper-maker.github.io/basics/img/battle-monsters.png)

モンスターはヒーローとまったく同じですが、バトルに関する追加情報があります。

* **報酬**:

  ![スクリーンショット](https://rpg-paper-maker.github.io/basics/img/battle-monsters-rewards.png)

  * `経験値`: バトルの最後にチームが獲得できる経験値を選択します。
  * `通貨`: バトルの最後にチームが獲得できる通貨を選択します。
  * `戦利品`: バトルの最後にチームが獲得できる戦利品です。

    * `数`: 戦利品のアイテムの数。
    * `確率`: 戦利品を獲得できる確率。
    * `レベル範囲`: 戦利品が利用可能なレベルの範囲を選択します。
    * `戦利品`: `アイテム`、`武器`、`防具` を選択します。

* **行動**:

ここでは、モンスターの AI を管理できます。次のオプションを使用して、モンスターの行動を指定できます。

![](.gitbook/assets/monster-action.png)

* `優先度`: 行動の優先度。他のすべての行動の優先度に応じた行動の確率（パーセント）を示す `確率` が下に表示されます。警告: 変数として優先度を設定すると、`?` が表示されます。
* `対象`:
  * `ランダム`: AI を使用せずにランダムな対象を攻撃します。
  * `弱い敵`: HP の低い対象を攻撃します。警告: これを機能させるには、共通ステータスの HP の省略形を削除または変更しないでください。
* **行動**:
  * `スキルIDを使用`: モンスターは選択したスキルを使用します。
  * `アイテムIDを使用`: モンスターは選択したアイテムを使用します。
  * `最大数`: モンスターが使用できるアイテムの最大数。0 未満の場合は、無限になります。
  * `何もしない`: モンスターは何もしません。
* **条件**:
  * `ターン値`: この行動は、バトルの現在のターン数に応じて実行できます。
  * `ステータスID`: この行動は、指定されたステータスの割合に応じて実行できます。注: これはバー（最大値を持つ）のみである必要があります。
  * `変数`: この行動は、変数の現在の値に応じて実行できます。
  * `ステータスIDの効果を受けている`: まだ利用できません。
  * `スクリプト`: この行動は、スクリプトの戻り値に応じて実行できます。

## 軍団 <a id="troops"></a>

![データマネージャー > 軍団タブ](https://rpg-paper-maker.github.io/basics/img/battle-troops.png)

軍団は、モンスターのグループと、リアクションを持ついくつかの状態に対応します。

* **モンスターリスト**:
  * `モンスター`: グループ内のモンスター。
  * `レベル`: モンスターのレベル。
* **状態**: _まだ利用できません。_

## 状態異常 <a id="status"></a>

_まだ利用できません。_

## アニメーション <a id="animations"></a>

![](.gitbook/assets/battle-animations.png)

アニメーションは、武器、スキル、アイテム、イベントコマンドのアニメーション表示に使用されます。これらの 2D アニメーションは、いくつかの異なるオプションを使用してカスタマイズできます。

* `画像`: アニメーション全体に使用されるテクスチャ。
* `位置`: 原点の位置を選択します。パネルに描画されたバトラーの例を使用して、この位置のインジケーターが表示されます。
* **フレーム**: アニメーションのさまざまなフレームのリスト。
  * **グラフィック**: 左クリックでパネルに要素を追加できます。

![](.gitbook/assets/widget-animation.png)

右クリックして `編集...` をクリックすると、要素のプロパティを編集できます。

![](.gitbook/assets/widget-animation-element-properties.png)

* `インデックス`: 要素のインデックス。要素は常に、インデックスの低い他の要素の上に描画されます。
* `X`: 要素の中心の x 座標。
* `Y`: 要素の中心の y 座標。
* `ズーム`: 要素のズーム（%）。
* `角度`: 要素の角度（°）。
* `垂直方向に反転`: チェックを入れると、要素は垂直方向に反転します。
* `不透明度`: 要素の不透明度（%）。

  左クリックする前に、このセレクターを使用してテクスチャを選択できます。

![](.gitbook/assets/widget-animation-texture.png)

* **オプション**:

  * `バトラーを変更`: パネルに表示するバトラーを変更します。
  * `フレームをコピー...`: 次のオプションを使用してフレームをコピーします。

  ![スクリーンショット](.gitbook/assets/animation-copy-frames.png)

  * **コピーするフレーム**: コピーするすべてのフレームを選択します。
  * `貼り付け元のフレーム`: このフレームから貼り付けます。
  * `フレームをクリア...`: 次のオプションを使用してフレームをクリアします。

  ![スクリーンショット](.gitbook/assets/animation-clear-frames.png)

  * `トランジションを作成...`: 次のオプションを使用して、複数のフレームにトランジションを作成します。

  ![スクリーンショット](.gitbook/assets/animation-create-transition.png)

  * **フレーム**: トランジションの開始フレームと終了フレーム。
  * **要素のインデックス**: トランジションを適用する要素のインデックス。
  * `X`、`Y`、`ズーム`、`角度`、`不透明度`: トランジションの終了時のオプションの値。プログレススライダーを使用して、トランジションの速度を選択できます。
  * `テクスチャを適用`: 選択した要素に選択したテクスチャを適用します。
  * `ヒットを再生`: ヒット時のアニメーションをテストします。
  * `ミスを再生`: ミス時のアニメーションをテストします。
  * `クリティカルを再生`: クリティカル時のアニメーションをテストします。
  * `行`: テクスチャアニメーションを分割する行数。デフォルト値は 5 です。
  * `列`: テクスチャアニメーションを分割する列数。デフォルト値は 5 です。

* **効果音/フラッシュ**: ここに効果（効果音またはフラッシュ）のリストを追加できます。

![スクリーンショット](.gitbook/assets/animation-effects.png)

* **効果**:
  * `効果音`: このフレームで再生するサウンドを選択します。
  * `フラッシュ`: _まだ利用できません。_
* `条件`: このサウンドを再生するか、このフラッシュを表示するための条件を選択します。
  * `なし`: 条件はありません。
  * `ヒット`: 攻撃がヒットしたとき。
  * `ミス`: 攻撃がミスしたとき。
  * `クリティカル`: クリティカル攻撃が発生したとき。